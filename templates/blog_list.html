{% extends "base.html" %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h3 class="mb-0">éƒ¨è½æ ¼ / å°ˆæ¡ˆç­†è¨˜</h3>
  <a href="{{ url_for('blog.blog_new') }}" class="btn btn-primary">æ–°å¢æ–‡ç« </a>
</div>

<form class="row g-2 mb-3" method="get">
  <div class="col-12 col-md-4">
    <input type="text" name="q" class="form-control"
           placeholder="æœå°‹æ¨™é¡Œ / å…§å®¹ / æ¨™ç±¤"
           value="{{ q }}">
  </div>

  <div class="col-6 col-md-3">
    <select name="category" class="form-select">
      <option value="">åˆ†é¡</option>
      {% for c in all_categories %}
        <option value="{{ c }}" {% if category == c %}selected{% endif %}>{{ c }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="col-6 col-md-3">
    <select name="status" class="form-select">
      <option value="">é€²åº¦</option>
      {% for s in all_statuses %}
        <option value="{{ s }}" {% if status == s %}selected{% endif %}>{{ s }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="col-6 col-md-2">
    <select name="sort_by" class="form-select">
      <option value="created_at_desc" {% if sort_by == "created_at_desc" %}selected{% endif %}>æœ€æ–°åœ¨å‰</option>
      <option value="created_at_asc" {% if sort_by == "created_at_asc" %}selected{% endif %}>æœ€èˆŠåœ¨å‰</option>
    </select>
  </div>

  <div class="col-6 col-md-auto">
    <button class="btn btn-outline-secondary w-100" type="submit">å¥—ç”¨</button>
  </div>
</form>

{% if posts %}
  <div class="list-group">
    {% for p in posts %}
      <a href="{{ url_for('blog.blog_detail', post_id=p.id) }}"
         class="list-group-item list-group-item-action">
        <div class="d-flex w-100 justify-content-between">
          <h5 class="mb-1">{{ p.title }}</h5>
          <small class="text-muted">
            {{ p.created_at or '' }}
          </small>
        </div>
        <p class="mb-1 text-muted small">
          {% if p.category %}åˆ†é¡ï¼š{{ p.category }}ã€€{% endif %}
          {% if p.status %}é€²åº¦ï¼š{{ p.status }}ã€€{% endif %}
          {% if p.project %}å°ˆæ¡ˆï¼š{{ p.project }}{% endif %}
        </p>
        {% if p.tags %}
          <small class="text-muted">æ¨™ç±¤ï¼š{{ p.tags }}</small>
        {% endif %}
      </a>
    {% endfor %}
  </div>
{% else %}
  <p class="text-muted">ç›®å‰é‚„æ²’æœ‰ä»»ä½•æ–‡ç« ï¼Œå¯ä»¥å…ˆæ–°å¢ä¸€ç¯‡ ğŸ˜„</p>
{% endif %}

{% endblock %}
